syntax = "proto3";

package api.facilities;

option go_package = "api/internal/proto/facilities;facilitiesservice";

message Facility {
  int64 id = 1;
  string name = 2;
  optional string image_path = 3;
  optional int64 capacity = 4;
  string created_at = 5;  // RFC3339 string
  string updated_at = 6;  // RFC3339 string
  string google_calendar_id = 7;
  optional int64 building_id = 8;
}

message Building {
  int64 id = 1;
  string name = 2;
  string address = 3;
  optional string image_path = 4;
  optional string google_calendar_id = 5;
}

message BuildingWithFacilities {
  Building building = 1;
  repeated FacilityWithCategories facilities = 2;
}

message Category {
  int64 id = 1;
  string name = 2;
  string description = 3;
  double price = 4;
  int64 facility_id = 5;
}

message FacilityWithCategories {
  Facility facility = 1;
  repeated Category categories = 2;
}

message Event {
  string summary = 1;
  string location = 2;
  string description = 3;
  string start = 4; 
  string end = 5;
  string html_link = 7;
  string title = 8;
}

service FacilitiesService {
  rpc GetAllFacilities (GetAllFacilitiesRequest) returns (GetAllFacilitiesResponse){
    option idempotency_level = NO_SIDE_EFFECTS;
  };
  rpc GetAllBuildings (GetAllBuildingsRequest) returns (GetAllBuildingsResponse){
    option idempotency_level = NO_SIDE_EFFECTS;
  };
  rpc GetFacility (GetFacilityRequest) returns (FullFacility){
    option idempotency_level = NO_SIDE_EFFECTS;
  };

  rpc GetEventsByFacility (GetEventsByFacilityRequest) returns (GetEventsByFacilityResponse){
    option idempotency_level = NO_SIDE_EFFECTS;
  };
  rpc GetEventsByBuilding (GetEventsByBuildingRequest) returns (GetEventsByBuildingResponse){
    option idempotency_level = NO_SIDE_EFFECTS;
  };
  rpc GetAllEvents (GetAllEventsRequest) returns (GetAllEventsResponse){
    option idempotency_level = NO_SIDE_EFFECTS;
  };
  rpc GetFacilityCategories (GetFacilityCategoriesRequest) returns (GetFacilityCategoriesResponse){
    option idempotency_level = NO_SIDE_EFFECTS;
  };
  rpc GetBuildingFacilities (GetBuildingFacilitiesRequest) returns (GetBuildingFacilitiesResponse){
    option idempotency_level = NO_SIDE_EFFECTS;
  };
  rpc CreateFacility (CreateFacilityRequest) returns (CreateFacilityResponse);
  rpc UpdateFacility (UpdateFacilityRequest) returns (UpdateFacilityResponse);
  rpc DeleteFacility (DeleteFacilityRequest) returns (DeleteFacilityResponse);
  rpc UpdateFacilityCategory (UpdateFacilityCategoryRequest) returns (Category);
  rpc GetCategory (GetCategoryRequest) returns (Category){
    option idempotency_level = NO_SIDE_EFFECTS;
  };
  
}

message GetCategoryRequest {
  int64 id = 1;
}
message GetEventsByFacilityRequest {
  int64 id = 1;
}

message GetEventsByFacilityResponse {
  repeated Event events = 1;
}

message GetEventsByBuildingRequest {
  int64 id = 1;
}

message GetEventsByBuildingResponse {
  repeated Event events = 1;
}

message GetAllEventsRequest {
  string calendar_id = 1;
}

message GetAllEventsResponse {
  repeated Event events = 1;
}
message GetAllBuildingsRequest {}

message GetAllBuildingsResponse {
  repeated Building buildings = 1;
}

message GetAllFacilitiesRequest {
}

message GetFacilityRequest {
  int64 id = 1;
}

message GetFacilityCategoriesRequest {
  int64 id = 1;
}

message GetBuildingFacilitiesRequest {
  int64 building_id = 1;
}
message GetAllFacilitiesResponse {
  repeated BuildingWithFacilities buildings = 1;
}

message GetFacilityCategoriesResponse {
  repeated Category categories = 1;
}

message GetBuildingFacilitiesResponse {
  BuildingWithFacilities building = 1;
}

message CreateFacilityRequest {
  Facility facility = 1;
  repeated Category categories = 2;
}

message UpdateFacilityRequest {
  Facility facility = 1;
  repeated Category categories = 2;
}

message DeleteFacilityRequest {
  int64 id = 1;
}

message DeleteFacilityResponse {}
message UpdateFacilityCategoryRequest {
  Category category = 1;
}
message CreateFacilityResponse {}
message UpdateFacilityResponse {}


message FullFacility {
  Facility facility = 1;
  repeated Category categories = 2;
  repeated int64 reservation_id = 3;
}

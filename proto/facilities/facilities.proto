syntax = "proto3";

package api.facilities;

option go_package = "api/internal/proto/facilities;facilitiesservice";

message Facility {
  int64 id = 1;
  string name = 2;
  string image_path = 3;
  int64 capacity = 4;
  string created_at = 5;  // RFC3339 string
  string updated_at = 6;  // RFC3339 string
  string google_calendar_id = 7;
  int64 building_id = 8;
  string product_id = 9;
}

message Building {
  int64 id = 1;
  string name = 2;
  string address = 3;
  string image_path = 4;
  string google_calendar_id = 5;
  double latitude = 6;
  double longitude = 7;
}

message BuildingWithFacilities {
  Building building = 1;
  repeated Facility facilities = 2;
}

message BuildingWithEvents {
  Building building = 1;
  repeated Event events = 2;
}

message Category {
  int64 id = 1;
  string name = 2;
  string description = 3;
}

message Pricing {
  string id = 1;
  string product_id = 2;
  double price = 3;
  int64 category_id = 4;
  string unit_label = 5;
}

message Event {
  string summary = 1;
  string location = 2;
  string description = 3;
  string start = 4; 
  string end = 5;
  string html_link = 7;
  string title = 8;
}

service FacilitiesService {
  rpc GetAllFacilities (GetAllFacilitiesRequest) returns (GetAllFacilitiesResponse){
    option idempotency_level = NO_SIDE_EFFECTS;
  };
  rpc GetAllBuildings (GetAllBuildingsRequest) returns (GetAllBuildingsResponse){
    option idempotency_level = NO_SIDE_EFFECTS;
  };
  rpc GetFacility (GetFacilityRequest) returns (FullFacility){
    option idempotency_level = NO_SIDE_EFFECTS;
  };

  rpc GetEventsByFacility (GetEventsByFacilityRequest) returns (GetEventsByFacilityResponse){
    option idempotency_level = NO_SIDE_EFFECTS;
  };
  rpc GetEventsByBuilding (GetEventsByBuildingRequest) returns (GetEventsByBuildingResponse){
    option idempotency_level = NO_SIDE_EFFECTS;
  };
  rpc GetAllEvents (GetAllEventsRequest) returns (GetAllEventsResponse){
    option idempotency_level = NO_SIDE_EFFECTS;
  };
  rpc GetFacilityCategories (GetFacilityCategoriesRequest) returns (GetFacilityCategoriesResponse){
    option idempotency_level = NO_SIDE_EFFECTS;
  };
  rpc GetBuildingFacilities (GetBuildingFacilitiesRequest) returns (GetBuildingFacilitiesResponse){
    option idempotency_level = NO_SIDE_EFFECTS;
  };
  rpc CreateFacility (CreateFacilityRequest) returns (CreateFacilityResponse);
  rpc UpdateFacility (UpdateFacilityRequest) returns (UpdateFacilityResponse);
  rpc DeleteFacility (DeleteFacilityRequest) returns (DeleteFacilityResponse);
  rpc UpdateFacilityCategory (UpdateFacilityCategoryRequest) returns (Category);
  rpc GetCategories (GetCategoriesRequest) returns (GetCategoriesResponse){
    option idempotency_level = NO_SIDE_EFFECTS;
  };
    
  rpc GetCategory (GetCategoryRequest) returns (Category){
    option idempotency_level = NO_SIDE_EFFECTS;
  };

  rpc GetAllCoords (GetAllCoordsRequest) returns (GetAllCoordsResponse){
    option idempotency_level = NO_SIDE_EFFECTS;
  };
  
}

message GetCategoriesRequest {}
message GetCategoriesResponse {
  repeated Category categories = 1;
}
message coords {
  int64 id = 1;
  string building = 2;
  double latitude = 3;
  double longitude = 4;
}

message GetAllCoordsRequest {}

message GetAllCoordsResponse {
  repeated coords data = 1;
}

message GetCategoryRequest {
  int64 id = 1;
}
message GetEventsByFacilityRequest {
  int64 id = 1;
}

message GetEventsByFacilityResponse {
  repeated Event events = 1;
}

message GetEventsByBuildingRequest {
  int64 id = 1;
}

message GetEventsByBuildingResponse {
  repeated Event events = 1;
}

message GetAllEventsRequest {}

message GetAllEventsResponse {
  repeated BuildingWithEvents data = 1;
}
message GetAllBuildingsRequest {}

message GetAllBuildingsResponse {
  repeated Building buildings = 1;
}

message GetAllFacilitiesRequest {
}

message GetFacilityRequest {
  int64 id = 1;
}

message GetFacilityCategoriesRequest {
  int64 id = 1;
}

message GetBuildingFacilitiesRequest {
  int64 building_id = 1;
}
message GetAllFacilitiesResponse {
  repeated BuildingWithFacilities buildings = 1;
}

message GetFacilityCategoriesResponse {
  repeated Category categories = 1;
}

message GetBuildingFacilitiesResponse {
  BuildingWithFacilities building = 1;
}

message CreateFacilityRequest {
  Facility facility = 1;
}

message UpdateFacilityRequest {
  Facility facility = 1;
}

message DeleteFacilityRequest {
  int64 id = 1;
}

message DeleteFacilityResponse {}
message UpdateFacilityCategoryRequest {
  Category category = 1;
}
message CreateFacilityResponse {}
message UpdateFacilityResponse {}
message PricingWithCategory {
  string id = 1;
  string product_id = 2;
  double price = 3;
  int64  category_id = 4;
  string unit_label = 5;
  string category_name = 6;
  string category_description = 7;
}


message FullFacility {
  Facility facility = 1;
  repeated PricingWithCategory pricing = 2;
  repeated int64 reservation_id = 3;
  Building building = 4;
}
